{"ast":null,"code":"import _asyncToGenerator from \"/Users/roipk/Documents/TeamWork/qlikshops_shop_owner/admin-panel/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { FormGroup, FormControl } from '@angular/forms';\nimport * as moment from 'moment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@services/order.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"../../components/table-footer/table-footer.component\";\nimport * as i6 from \"ngx-pagination\";\nimport * as i7 from \"@ngx-translate/core\";\nfunction HistoryComponent_tr_58_img_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 34);\n  }\n}\nfunction HistoryComponent_tr_58_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\", 28);\n    i0.ɵɵlistener(\"click\", function HistoryComponent_tr_58_Template_tr_click_0_listener() {\n      const open_r5 = i0.ɵɵrestoreView(_r4).$implicit;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.openDetail(open_r5.order_id));\n    });\n    i0.ɵɵelementStart(1, \"th\", 29);\n    i0.ɵɵtemplate(2, HistoryComponent_tr_58_img_2_Template, 1, 0, \"img\", 30);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\", 31);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\", 32);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\", 32);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\", 31);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\", 32);\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"td\", 33);\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const open_r5 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", (open_r5 == null ? null : open_r5.is_cancelled) == 1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", open_r5 == null ? null : open_r5.order_id, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", open_r5 == null ? null : open_r5.client_name, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", open_r5 == null ? null : open_r5.address, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", open_r5 == null ? null : open_r5.num_of_items, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", open_r5 == null ? null : open_r5.order_total, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", open_r5 == null ? null : open_r5.order_time, \" \");\n  }\n}\nexport let HistoryComponent = /*#__PURE__*/(() => {\n  class HistoryComponent {\n    constructor(orderService) {\n      this.orderService = orderService;\n      this.openOrders = [];\n      this.originData = [];\n      this.startDate = {};\n      this.historyForm = new FormGroup({\n        fromDate: new FormControl(this.startDate),\n        toDate: new FormControl(null),\n        keyWord: new FormControl(null)\n      });\n      this.tableOptions = {\n        id: 'table',\n        currentPage: 0,\n        itemsPerPage: 10\n      };\n    }\n    get fromDate() {\n      if (this.historyForm.value.fromDate != null) {\n        return `${this.historyForm.value.fromDate.year}-${this.historyForm.value.fromDate.month}-${this.historyForm.value.fromDate.day}`;\n      } else {\n        return null;\n      }\n    }\n    get toDate() {\n      if (this.historyForm.value.fromDate != null) {\n        return `${this.historyForm.value.toDate.year}-${this.historyForm.value.toDate.month}-${this.historyForm.value.toDate.day}`;\n      } else {\n        return null;\n      }\n    }\n    get keyWord() {\n      return this.historyForm.value.keyWord;\n    }\n    get remainEntries() {\n      return this.openOrders.length % this.tableOptions.itemsPerPage;\n    }\n    iniDate() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        const currentDate = yield moment().valueOf();\n        const onWeekBefore = currentDate - 604800000;\n        _this.startDate = {\n          year: moment(onWeekBefore).get('year'),\n          month: 1 + moment(onWeekBefore).get('month'),\n          day: moment(onWeekBefore).get('date')\n        };\n        _this.currentDate = {\n          year: moment(currentDate).get('year'),\n          month: 1 + moment(currentDate).get('month'),\n          day: moment(currentDate).get('date')\n        };\n        _this.historyForm.patchValue({\n          fromDate: _this.startDate,\n          toDate: _this.currentDate\n        });\n      })();\n    }\n    ngOnInit() {\n      this.orderService.getHistoryByRange().subscribe(res => {\n        this.openOrders = res.orders;\n        this.originData = res.orders;\n      });\n      this.iniDate();\n    }\n    openDetail(id) {\n      const url = `/order/history/shop-page/detail/${id}`;\n      window.open(url, '_blank');\n    }\n    searchingByDate() {\n      this.orderService.getHistoryByRange(this.fromDate, this.toDate, this.keyWord).subscribe(res => {\n        this.openOrders = res.orders;\n      });\n    }\n    clearForm() {\n      this.historyForm.reset();\n      this.openOrders = this.originData;\n    }\n    static #_ = this.ɵfac = function HistoryComponent_Factory(t) {\n      return new (t || HistoryComponent)(i0.ɵɵdirectiveInject(i1.OrderService));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: HistoryComponent,\n      selectors: [[\"app-history\"]],\n      decls: 62,\n      vars: 40,\n      consts: [[\"pickStartedDate\", \"ngbDatepicker\"], [\"pickEndedDate\", \"ngbDatepicker\"], [1, \"open-purchase\", \"p-4\", \"direction-right\"], [1, \"container\", \"bg-light\", \"rounded\"], [1, \"row\"], [1, \"col-12\", \"p-4\"], [1, \"search-section\"], [3, \"formGroup\"], [1, \"container\"], [1, \"col-12\", \"col-md-2\", \"p-md-0\", \"form-group\"], [1, \"input-wrapper\"], [\"name\", \"fromDate\", \"formControlName\", \"fromDate\", \"ngbDatepicker\", \"\", 1, \"form-control\", 3, \"placeholder\"], [\"aria-hidden\", \"true\", 1, \"fa\", \"fa-calendar-alt\", \"right-icon\", \"text-primary\", \"cursor-pointer\", 3, \"click\"], [1, \"col-12\", \"col-md-2\", \"form-group\"], [\"name\", \"toDate\", \"formControlName\", \"toDate\", \"ngbDatepicker\", \"\", 1, \"form-control\", 3, \"placeholder\"], [1, \"col-12\", \"col-md-4\", \"form-group\"], [\"formControlName\", \"keyWord\", \"type\", \"text\", 1, \"form-control\", 3, \"placeholder\"], [\"aria-hidden\", \"true\", 1, \"fa\", \"fa-search\", \"right-icon\", \"text-primary\"], [1, \"btn\", \"btn-primary\", \"px-4\", \"py-1\", \"w-100\", 3, \"click\"], [1, \"btn\", \"btn-info\", \"px-4\", \"py-1\", \"w-100\", 3, \"click\"], [1, \"bg-primary\"], [1, \"table-section\", \"p-2\"], [1, \"table\", \"rounded\"], [\"scope\", \"col\"], [\"scope\", \"col\", 1, \"text-center\"], [\"scope\", \"col\", 1, \"text-right\"], [3, \"click\", 4, \"ngFor\", \"ngForOf\"], [3, \"tableOptions\", \"items\"], [3, \"click\"], [\"scope\", \"row\", 2, \"width\", \"70px\"], [\"class\", \"icon-banner ribbon\", \"src\", \"assets/icons/cancel.png\", \"alt\", \"new_icon\", 4, \"ngIf\"], [1, \"align-middle\", \"text-center\"], [1, \"align-middle\"], [1, \"align-middle\", \"text-right\"], [\"src\", \"assets/icons/cancel.png\", \"alt\", \"new_icon\", 1, \"icon-banner\", \"ribbon\"]],\n      template: function HistoryComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelementStart(0, \"div\", 2)(1, \"div\", 3)(2, \"div\", 4)(3, \"div\", 5)(4, \"div\", 6)(5, \"form\", 7)(6, \"div\", 8)(7, \"div\", 4)(8, \"div\", 9)(9, \"div\", 10);\n          i0.ɵɵelement(10, \"input\", 11, 0);\n          i0.ɵɵpipe(12, \"translate\");\n          i0.ɵɵelementStart(13, \"i\", 12);\n          i0.ɵɵlistener(\"click\", function HistoryComponent_Template_i_click_13_listener() {\n            i0.ɵɵrestoreView(_r1);\n            const pickStartedDate_r2 = i0.ɵɵreference(11);\n            return i0.ɵɵresetView(pickStartedDate_r2.toggle());\n          });\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(14, \"div\", 13)(15, \"div\", 10);\n          i0.ɵɵelement(16, \"input\", 14, 1);\n          i0.ɵɵpipe(18, \"translate\");\n          i0.ɵɵelementStart(19, \"i\", 12);\n          i0.ɵɵlistener(\"click\", function HistoryComponent_Template_i_click_19_listener() {\n            i0.ɵɵrestoreView(_r1);\n            const pickEndedDate_r3 = i0.ɵɵreference(17);\n            return i0.ɵɵresetView(pickEndedDate_r3.toggle());\n          });\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(20, \"div\", 15)(21, \"div\", 10);\n          i0.ɵɵelement(22, \"input\", 16);\n          i0.ɵɵpipe(23, \"translate\");\n          i0.ɵɵelement(24, \"i\", 17);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(25, \"div\", 13)(26, \"button\", 18);\n          i0.ɵɵlistener(\"click\", function HistoryComponent_Template_button_click_26_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.searchingByDate());\n          });\n          i0.ɵɵtext(27);\n          i0.ɵɵpipe(28, \"translate\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(29, \"div\", 9)(30, \"button\", 19);\n          i0.ɵɵlistener(\"click\", function HistoryComponent_Template_button_click_30_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.clearForm());\n          });\n          i0.ɵɵtext(31);\n          i0.ɵɵpipe(32, \"translate\");\n          i0.ɵɵelementEnd()()()()()();\n          i0.ɵɵelement(33, \"hr\", 20);\n          i0.ɵɵelementStart(34, \"div\", 21)(35, \"table\", 22)(36, \"thead\")(37, \"tr\");\n          i0.ɵɵelement(38, \"th\", 23);\n          i0.ɵɵelementStart(39, \"th\", 24);\n          i0.ɵɵtext(40);\n          i0.ɵɵpipe(41, \"translate\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(42, \"th\", 23);\n          i0.ɵɵtext(43);\n          i0.ɵɵpipe(44, \"translate\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(45, \"th\", 23);\n          i0.ɵɵtext(46);\n          i0.ɵɵpipe(47, \"translate\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(48, \"th\", 24);\n          i0.ɵɵtext(49);\n          i0.ɵɵpipe(50, \"translate\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(51, \"th\", 23);\n          i0.ɵɵtext(52);\n          i0.ɵɵpipe(53, \"translate\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(54, \"th\", 25);\n          i0.ɵɵtext(55);\n          i0.ɵɵpipe(56, \"translate\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(57, \"tbody\");\n          i0.ɵɵtemplate(58, HistoryComponent_tr_58_Template, 15, 7, \"tr\", 26);\n          i0.ɵɵpipe(59, \"paginate\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelement(60, \"hr\", 20)(61, \"app-table-footer\", 27);\n          i0.ɵɵelementEnd()()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"formGroup\", ctx.historyForm);\n          i0.ɵɵadvance(5);\n          i0.ɵɵpropertyInterpolate(\"placeholder\", i0.ɵɵpipeBind1(12, 15, \"history.from_date\"));\n          i0.ɵɵadvance(6);\n          i0.ɵɵpropertyInterpolate(\"placeholder\", i0.ɵɵpipeBind1(18, 17, \"history.to_date\"));\n          i0.ɵɵadvance(6);\n          i0.ɵɵpropertyInterpolate(\"placeholder\", i0.ɵɵpipeBind1(23, 19, \"clients.label\"));\n          i0.ɵɵadvance(5);\n          i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(28, 21, \"clients.btn_search\"), \" \");\n          i0.ɵɵadvance(4);\n          i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(32, 23, \"clients.btn_clear\"), \" \");\n          i0.ɵɵadvance(9);\n          i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(41, 25, \"purchase.order_id\"));\n          i0.ɵɵadvance(3);\n          i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(44, 27, \"purchase.name\"));\n          i0.ɵɵadvance(3);\n          i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(47, 29, \"purchase.address\"));\n          i0.ɵɵadvance(3);\n          i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(50, 31, \"purchase.num_items\"));\n          i0.ɵɵadvance(3);\n          i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(53, 33, \"purchase.order_total\"));\n          i0.ɵɵadvance(3);\n          i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(56, 35, \"purchase.order_time\"));\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind2(59, 37, ctx.openOrders, ctx.tableOptions));\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"tableOptions\", ctx.tableOptions)(\"items\", ctx.openOrders);\n        }\n      },\n      dependencies: [i2.NgForOf, i2.NgIf, i3.NgbInputDatepicker, i4.ɵNgNoValidate, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i5.TableFooterComponent, i4.FormGroupDirective, i4.FormControlName, i6.PaginatePipe, i7.TranslatePipe]\n    });\n  }\n  return HistoryComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}